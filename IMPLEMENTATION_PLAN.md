# Meta-Ralph Implementation Plan

> **Last Updated:** 2026-01-25 (Phase 2, 3, 5.1, 5.2, 5.3, & 5.4 completed)
> **Generated by:** Claude Opus 4.5 comprehensive analysis of specs vs. source code
> **Priority Legend:** P0 = Critical, P1 = High, P2 = Medium, P3 = Low

---

## Executive Summary

This plan outlines the implementation gaps between the current Meta-Ralph codebase and the specifications in `specs/`. The CLI core is **complete** with Zeropath and Sentry providers fully functional. The UI has **basic functionality** but requires significant work for PRD-001 (Enhanced UI). The Codecov Provider (PRD-002) is **not started**.

### Progress Tracker
| Phase | Status | Completed Items |
|-------|--------|-----------------|
| Quick Wins | ✅ Complete | QW-1 Extended Types, QW-2 Table Header Sorting |
| Phase 1.1 Core Hooks | ✅ Complete | useLocalStorage, useSort, useSearch, useFilters |
| Phase 1.2 Global State | ✅ Complete | AppContext, Providers |
| Phase 2 Search & Filtering | ✅ Complete | SearchBar, SearchHighlight, FilterBar, FilterChip, FilterPreset, RangeSlider |
| Phase 3 Bulk Actions & Details | ✅ Complete | BulkActionBar, ExportDialog, IssueDetailPanel, IssueMetadata, CodeSnippet |
| Phase 4 Codecov Provider | ❌ Not Started | PRD-002 implementation |
| Phase 5.1 Keyboard Shortcuts | ✅ Complete | useKeyboardShortcuts, ShortcutsModal, shortcuts.ts |
| Phase 5.2 Grouping Views | ✅ Complete | GroupedView, GroupHeader, ViewToggle, useGrouping |
| Phase 5.3 Dashboard | ✅ Complete | Dashboard, StatCard, ProviderPieChart, SeverityBarChart, PriorityHistogram, TopFilesTable |
| Phase 5.4 Processing Queue | ✅ Complete | ProcessingQueue, QueueItem, QueueProgress, keyboard shortcuts |

---

## Implementation Status Overview

### CLI Core: COMPLETE
| Component | Status | Notes |
|-----------|--------|-------|
| `meta-ralph.sh` | ✅ Complete | Full orchestrator with dry-run, JSON output, filtering |
| `lib/provider.sh` | ✅ Complete | Provider interface with 4 required functions |
| `lib/priority.sh` | ✅ Complete | Cross-platform priority normalization (0-100) |
| `lib/ralph-engine.sh` | ✅ Complete | Claude Code fix loop with `<promise>COMPLETE</promise>` detection |
| `config.sh` | ✅ Complete | Centralized configuration, .env support |

### Providers
| Provider | Status | Notes |
|----------|--------|-------|
| `providers/zeropath/provider.sh` | ✅ Complete | Full API integration, PRD generation, branch naming |
| `providers/sentry/provider.sh` | ✅ Complete | Full API integration, stack traces, PRD generation |
| `providers/github/` | ❌ Empty | Directory exists but contains no files |
| `providers/codecov/` | ❌ Not Started | Directory does not exist (PRD-002) |

### UI Core
| Component | Status | Notes |
|-----------|--------|-------|
| `ui/src/lib/types.ts` | ✅ Complete | Extended with all PRD-001 types (Severity, IssueStatus, ExtendedIssue, FilterState, SortState, etc.) |
| `ui/src/components/IssueTable.tsx` | ✅ Sorting | Clickable sortable headers with visual indicators (↑/↓/↕) |
| `ui/src/components/IssueRow.tsx` | ✅ Complete | Row component with severity badges, priority coloring |
| `ui/src/components/ProcessButton.tsx` | ✅ Complete | Basic process button with loading state |
| `ui/src/components/LogViewer.tsx` | ✅ Complete | Log display with color-coded messages |
| `ui/src/app/page.tsx` | ✅ Complete | Refactored to use AppContext for global state |
| `ui/src/app/api/issues/route.ts` | ⚠️ Basic | GET/POST; missing bulk, stream endpoints |
| `ui/src/app/globals.css` | ⚠️ Partial | Dark theme only; missing light theme |

### UI Not Implemented (PRD-001)
| Directory/Component | Status | Spec Reference |
|---------------------|--------|----------------|
| `ui/src/hooks/` | ✅ Core Complete | useLocalStorage, useSort, useSearch, useFilters implemented |
| `ui/src/contexts/` | ✅ Complete | AppContext implemented |
| `ui/src/components/filters/` | ✅ Complete | FilterBar, FilterChip, FilterPreset, RangeSlider |
| `ui/src/components/search/` | ✅ Complete | SearchBar, SearchHighlight |
| `ui/src/components/views/` | ✅ Complete | GroupedView, GroupHeader, ViewToggle implemented |
| `ui/src/components/actions/` | ✅ Complete | BulkActionBar, ExportDialog |
| `ui/src/components/details/` | ✅ Complete | IssueDetailPanel, IssueMetadata, CodeSnippet |
| `ui/src/components/dashboard/` | ✅ Complete | Dashboard, StatCard, ProviderPieChart, SeverityBarChart, PriorityHistogram, TopFilesTable |
| `ui/src/components/queue/` | ✅ Complete | ProcessingQueue, QueueItem, QueueProgress |
| `ui/src/components/tags/` | ❌ Not Started | TagInput, TagBadge, TagManager |
| `ui/src/components/common/` | ✅ Complete | KeyboardShortcuts, ShortcutsModal |
| `ui/src/components/history/` | ❌ Not Started | HistoryView, HistoryItem |
| `ui/src/app/api/issues/bulk/` | ❌ Not Started | POST /api/issues/bulk |
| `ui/src/app/api/issues/stream/` | ❌ Not Started | GET /api/issues/stream (SSE) |

### Missing Dependencies (package.json)
```json
{
  "recharts": "^2.12.0",        // Dashboard charts ✅ INSTALLED
  "@dnd-kit/core": "^6.1.0",    // Drag and drop
  "@dnd-kit/sortable": "^8.0.0", // Sortable lists
  "@tanstack/react-virtual": "^3.5.0", // List virtualization
  "date-fns": "^3.3.0"          // Date utilities
}
```

---

## Priority Implementation Order

### Quick Wins (Start Here)

#### QW-1: Extended Types ✅ COMPLETED
**Priority:** P0 | **Effort:** 1-2 hours | **File:** `ui/src/lib/types.ts`

All types required by PRD-001 have been added:

- [x] `Severity` - Type union for severity levels
- [x] `IssueStatus` - 'pending' | 'processing' | 'completed' | 'failed' | 'ignored'
- [x] `ExtendedIssue` - extends Issue with tags, status, processedAt, prUrl
- [x] `FilterState` - providers[], severities[], priorityRange, dateRange, countRange, status[], tags[], search
- [x] `SortState` - field, direction
- [x] `SortField` - Type for sortable fields
- [x] `SortDirection` - 'asc' | 'desc'
- [x] `SavedView` - id, name, filters, sort, groupBy, isDefault
- [x] `Tag` - id, name, color
- [x] `QueueItem` - issueId, status, startedAt, completedAt, prUrl, error
- [x] `GroupBy` - Type for grouping options
- [x] `DashboardStats` - Statistics types
- [x] `IssuesApiResponse` - API response type
- [x] `BulkActionRequest` / `BulkActionResponse` - Bulk action types
- [x] Utility constants: SEVERITIES, SEVERITY_ORDER, DEFAULT_FILTERS, DEFAULT_SORT

---

#### QW-2: Table Header Sorting ✅ COMPLETED
**Priority:** P0 | **Effort:** 2-3 hours | **Files:** `ui/src/components/IssueTable.tsx`, `ui/src/app/page.tsx`

Table headers are now clickable with sort functionality:

- [x] Clickable table headers with sort indicators (↑/↓/↕ arrows)
- [x] Client-side sorting by Priority, Severity, Count, Title, Provider, Date (with fallback)
- [x] Persist sort preference in localStorage
- [ ] URL param sync: `?sort=priority&dir=desc` (pending)

---

### Phase 1: Foundation (P0)

#### 1.1 Core Hooks ✅ COMPLETED
**Priority:** P0 | **Effort:** Medium | **Directory:** `ui/src/hooks/`

Directory created with foundational hooks implemented:

- [x] Created `ui/src/hooks/` directory
- [x] `useLocalStorage.ts` - Generic typed localStorage hook with SSR safety
- [x] `useSort.ts` - Sort state management with localStorage persistence
- [x] `useFilters.ts` - Filter state management with optional URL sync
- [x] `useSearch.ts` - Search with 200ms debouncing and search history
- [x] `hooks/index.ts` - Barrel exports for all hooks

**Files created:**
- `ui/src/hooks/useLocalStorage.ts`
- `ui/src/hooks/useSort.ts`
- `ui/src/hooks/useSearch.ts`
- `ui/src/hooks/useFilters.ts`
- `ui/src/hooks/index.ts`

---

#### 1.2 Global State Context ✅ COMPLETED
**Priority:** P0 | **Effort:** Medium | **Directory:** `ui/src/contexts/`

Global state management via AppContext implemented:

- [x] Created `ui/src/contexts/` directory
- [x] Created `AppContext.tsx` with comprehensive state management:
  - Issues state (with filtering/sorting)
  - Selection state
  - Processing queue state
  - Filter/sort state
- [x] Created `Providers.tsx` client wrapper for AppProvider
- [x] Created barrel exports in `index.ts`
- [x] Wrapped app in AppProvider via layout.tsx
- [x] Refactored page.tsx to use context (reduced from 307 to 194 lines)

**Files created:**
- `ui/src/contexts/AppContext.tsx`
- `ui/src/contexts/Providers.tsx`
- `ui/src/contexts/index.ts`

**Implementation details:**
- Centralized issues, filters, sorting, and selection state
- Reduced page.tsx complexity by moving state logic to context
- Client-side provider wraps entire app via layout.tsx
- All state changes propagate globally to dependent components

---

### Phase 2: Search & Filtering (P0) ✅ COMPLETED

#### 2.1 Search Functionality ✅ COMPLETED
**Priority:** P0 | **Effort:** Medium | **Directory:** `ui/src/components/search/`

Full search functionality implemented:

- [x] Created `SearchBar.tsx` - Input with clear button, scope selector
- [x] Created `SearchHighlight.tsx` - Highlight matching text in results
- [x] Implemented instant search (debounced 200ms)
- [x] Added search history (last 10 in localStorage)
- [x] Added keyboard shortcut `/` to focus search

**Files created:**
- `ui/src/components/search/SearchBar.tsx`
- `ui/src/components/search/SearchHighlight.tsx`

---

#### 2.2 Advanced Filtering System ✅ COMPLETED
**Priority:** P0 | **Effort:** Large | **Directory:** `ui/src/components/filters/`

Advanced filtering system implemented:

- [x] Created `FilterBar.tsx` - Collapsible filter panel below header
- [x] Created `FilterChip.tsx` - Active filter badges with remove button
- [x] Created `FilterPreset.tsx` - Quick filter buttons (Critical Only, Security Only, High Volume, Recent)
- [x] Created `RangeSlider.tsx` - Dual-handle range input for priority (0-100)
- [ ] Create `DateRangePicker.tsx` - Date range selection (First seen, Last seen) (deferred)
- [x] Implemented filter state with URL query param sync
- [x] Multi-select for providers and severities

**Files created:**
- `ui/src/components/filters/FilterBar.tsx`
- `ui/src/components/filters/FilterChip.tsx`
- `ui/src/components/filters/FilterPreset.tsx`
- `ui/src/components/filters/RangeSlider.tsx`

**Filters implemented:**
| Filter | Type | Values |
|--------|------|--------|
| Provider | Multi-select | zeropath, sentry, codecov, github |
| Severity | Multi-select | CRITICAL, HIGH, MEDIUM, LOW, INFO |
| Priority Range | Range slider | 0-100 |
| Status | Multi-select | pending, processing, completed, failed, ignored |

---

### Phase 3: Bulk Actions & Detail Panel (P0) ✅ COMPLETED

#### 3.1 Bulk Actions System ✅ COMPLETED
**Priority:** P0 | **Effort:** Medium | **Directory:** `ui/src/components/actions/`

Bulk actions system implemented:

- [x] Created `BulkActionBar.tsx` - Sticky bar at bottom when items selected
- [ ] Create `ActionConfirmDialog.tsx` - Confirmation modal for destructive actions (deferred)
- [x] Created `ExportDialog.tsx` - Format and field selection for export
- [x] Created `ui/src/lib/export.ts` - Client-side CSV/JSON export generation
- [ ] Create `POST /api/issues/bulk` endpoint (deferred)

**Files created:**
- `ui/src/components/actions/BulkActionBar.tsx`
- `ui/src/components/actions/ExportDialog.tsx`
- `ui/src/lib/export.ts`

**Actions implemented:**
| Action | Status |
|--------|--------|
| Select by Filter | Implemented |
| Process Selected | Implemented (existing) |
| Export Selected (CSV/JSON) | Implemented |

---

#### 3.2 Issue Detail Panel ✅ COMPLETED
**Priority:** P0 | **Effort:** Medium | **Directory:** `ui/src/components/details/`

Issue detail panel implemented:

- [x] Created `IssueDetailPanel.tsx` - Slide-out panel (40% width)
- [x] Created `IssueMetadata.tsx` - Provider-specific metadata display
- [x] Created `CodeSnippet.tsx` - Syntax-highlighted code with copy functionality
- [ ] Create `ActionButtons.tsx` - Quick action buttons (deferred)
- [x] Added keyboard navigation: Escape to close

**Files created:**
- `ui/src/components/details/IssueDetailPanel.tsx`
- `ui/src/components/details/IssueMetadata.tsx`
- `ui/src/components/details/CodeSnippet.tsx`

**Panel sections implemented:**
- Header: Title, ID, Provider badge, Severity badge
- Metrics: Priority score, Count, First/Last seen
- Description: Full description text
- Location: File path with link to source
- Metadata: Provider-specific (stack traces, vuln class, etc.)
- Actions: Process, View Original, Copy Link

---

### Phase 4: Codecov Provider (P1 - PRD-002)

#### 4.1 Provider Directory & Core Implementation
**Priority:** P1 | **Effort:** Large | **Directory:** `providers/codecov/`

Directory does not exist. Create per PRD-002:

- [ ] Create `providers/codecov/` directory
- [ ] Create `providers/codecov/provider.sh` with:
  - `provider_name()` returning "codecov"
  - `provider_fetch()` with Codecov API integration
  - `provider_gen_prd()` for test-focused PRDs
  - `provider_branch_name()` returning `test/coverage-{filename}`
  - `provider_pr_body()` with coverage metrics

**Normalized issue format:**
```json
{
  "id": "codecov-{file-hash}",
  "provider": "codecov",
  "title": "Low coverage: src/lib/utils.ts (23%)",
  "severity": "MEDIUM",
  "priority": 65,
  "metadata": {
    "coverage_percent": 23,
    "lines_covered": 13,
    "lines_missed": 45,
    "is_critical_path": true
  }
}
```

---

#### 4.2 Codecov API Helpers
**Priority:** P1 | **Effort:** Small | **File:** `providers/codecov/api.sh`

- [ ] Create API helper functions for Codecov endpoints
- [ ] Implement `GET /api/v2/repos/{service}/{owner}/{repo}/report`
- [ ] Implement `GET /api/v2/repos/{service}/{owner}/{repo}/file_report/{path}`
- [ ] Add error handling for API responses (401, 404, 429)

---

#### 4.3 Priority Calculation
**Priority:** P1 | **Effort:** Small | **File:** `providers/codecov/priority.sh`

- [ ] Implement `calculate_codecov_priority()` function
- [ ] Apply weight factors: critical path (1.5x), large file (1.2x), recent changes (1.3x), high complexity (1.2x)
- [ ] Map coverage to severity: 0-20% CRITICAL, 21-40% HIGH, 41-60% MEDIUM, etc.

---

#### 4.4 Test Framework Detection
**Priority:** P1 | **Effort:** Small | **File:** `providers/codecov/test-detection.sh`

- [ ] Implement `detect_test_framework()` for JS/TS, Python, Rust, Go
- [ ] Implement `get_test_command()` returning appropriate test command
- [ ] Implement `get_test_file_pattern()` for test file location
- [ ] Implement `get_framework_guidelines()` for PRD generation

---

#### 4.5 Configuration Updates
**Priority:** P1 | **Effort:** Small | **Files:** `config.sh`, `.env.example`

- [ ] Add Codecov configuration section to `config.sh`
- [ ] Add environment variables:
  - `CODECOV_API_TOKEN`
  - `CODECOV_SERVICE` (github/gitlab/bitbucket)
  - `CODECOV_OWNER`
  - `CODECOV_REPO`
  - `CODECOV_API_URL` (default: https://api.codecov.io)
  - `CODECOV_MIN_COVERAGE` (default: 50)
  - `CODECOV_TARGET_COVERAGE` (default: 80)
  - `CODECOV_MAX_FILES` (default: 20)
  - `CODECOV_CRITICAL_PATHS`
  - `CODECOV_EXCLUDE_PATTERNS`
- [ ] Update `.env.example` with Codecov variables

---

### Phase 5: Enhanced UX (P1)

#### 5.1 Keyboard Shortcuts ✅ COMPLETED
**Priority:** P1 | **Effort:** Medium | **Directory:** `ui/src/components/common/`

Keyboard shortcuts fully implemented with comprehensive functionality:

- [x] Created `ui/src/lib/shortcuts.ts` with shortcut definitions and utilities
- [x] Created `ui/src/hooks/useKeyboardShortcuts.ts` for handling keyboard events
- [x] Created `ui/src/components/common/ShortcutsModal.tsx` for help modal
- [x] Created `ui/src/components/common/KeyboardShortcuts.tsx` for event handling
- [x] Updated SearchBar with forwardRef for focus support
- [x] Updated FilterBar with controlled expanded state
- [x] Integrated KeyboardShortcuts in page.tsx
- [x] Added 22 tests for keyboard shortcuts functionality

**Shortcut map implemented:**
| Key | Action |
|-----|--------|
| `j` / `↓` | Navigate down |
| `k` / `↑` | Navigate up |
| `x` | Toggle selection |
| `Space` | Open/close detail panel |
| `Enter` | Process selected |
| `Escape` | Close panel / Clear selection |
| `/` | Focus search |
| `?` | Show shortcuts help |
| `Ctrl/Cmd+A` | Select all |
| `Ctrl/Cmd+Shift+A` | Deselect all |
| `f` | Focus filter bar |
| `r` | Refresh issues |
| `q` | Toggle queue panel |
| `1-5` | Quick filter by severity |

**Files created:**
- `ui/src/lib/shortcuts.ts`
- `ui/src/hooks/useKeyboardShortcuts.ts`
- `ui/src/components/common/KeyboardShortcuts.tsx`
- `ui/src/components/common/ShortcutsModal.tsx`

---

#### 5.2 Grouping Views ✅ COMPLETED
**Priority:** P1 | **Effort:** Medium | **Directory:** `ui/src/components/views/`

Grouping views fully implemented with comprehensive functionality:

- [x] Create `GroupedView.tsx` - Container for grouped sections
- [x] Create `GroupHeader.tsx` - Collapsible header with count badge
- [x] Create `ViewToggle.tsx` - Switch between table/grouped views
- [x] Implement group by: Provider, Severity, Date, Location, None
- [x] Store collapsed groups in localStorage
- [x] Add keyboard shortcuts: `c` collapse all, `e` expand all, `g` cycle group by

**Files created:**
- `ui/src/components/views/GroupedView.tsx`
- `ui/src/components/views/GroupHeader.tsx`
- `ui/src/components/views/ViewToggle.tsx`
- `ui/src/hooks/useGrouping.ts`

**Tests created:**
- `ui/src/hooks/__tests__/useGrouping.test.tsx`
- `ui/src/components/views/__tests__/ViewToggle.test.tsx`
- `ui/src/components/views/__tests__/GroupHeader.test.tsx`

**Integration:**
- AppContext extended with grouping state (groupBy, collapsedGroups)
- page.tsx updated with ViewToggle and GroupedView components
- Keyboard shortcuts integrated for grouping controls

---

#### 5.3 Dashboard with Statistics ✅ COMPLETED
**Priority:** P1 | **Effort:** Large | **Directory:** `ui/src/components/dashboard/`

Dashboard fully implemented with comprehensive statistics visualization:

- [x] Add `recharts` dependency to package.json
- [x] Create `Dashboard.tsx` - Main collapsible dashboard section
- [x] Create `StatCard.tsx` - Individual metric cards with variants
- [x] Create `ProviderPieChart.tsx` - Issues by provider (donut chart)
- [x] Create `SeverityBarChart.tsx` - Issues by severity (horizontal bar)
- [x] Create `PriorityHistogram.tsx` - Priority distribution (vertical bar)
- [x] Create `TopFilesTable.tsx` - Top files by issue count
- [x] Add toggle to show/hide dashboard (stored in localStorage)
- [x] Integrate Dashboard into page.tsx
- [x] Add comprehensive tests for all components

**Files created:**
- `ui/src/components/dashboard/Dashboard.tsx`
- `ui/src/components/dashboard/StatCard.tsx`
- `ui/src/components/dashboard/ProviderPieChart.tsx`
- `ui/src/components/dashboard/SeverityBarChart.tsx`
- `ui/src/components/dashboard/PriorityHistogram.tsx`
- `ui/src/components/dashboard/TopFilesTable.tsx`
- `ui/src/components/dashboard/index.ts`
- `ui/src/components/dashboard/__tests__/Dashboard.test.tsx`
- `ui/src/components/dashboard/__tests__/StatCard.test.tsx`
- `ui/src/components/dashboard/__tests__/TopFilesTable.test.tsx`

**Metrics displayed:**
- Total issues count (stat card)
- Critical issues count (stat card)
- High priority issues count (stat card)
- Processing success rate percentage (stat card)
- Issues by provider (pie chart)
- Issues by severity (horizontal bar chart)
- Priority distribution (histogram)
- Top 5 files by issues (table)

---

#### 5.4 Processing Queue Visualization ✅ COMPLETED
**Priority:** P1 | **Effort:** Medium | **Directory:** `ui/src/components/queue/`

Processing queue visualization fully implemented:

- [x] Create `ProcessingQueue.tsx` - Queue visualization sidebar
- [x] Create `QueueItem.tsx` - Individual item in queue
- [x] Create `QueueProgress.tsx` - Overall progress bar with ETA
- [ ] Add cancel button for pending items (deferred)
- [ ] Add pause/resume queue functionality (deferred)
- [x] Show current issue with spinner

**Files created:**
- `ui/src/components/queue/ProcessingQueue.tsx`
- `ui/src/components/queue/QueueItem.tsx`
- `ui/src/components/queue/QueueProgress.tsx`
- `ui/src/components/queue/index.ts`
- `ui/src/components/queue/__tests__/ProcessingQueue.test.tsx`
- `ui/src/components/queue/__tests__/QueueItem.test.tsx`
- `ui/src/components/queue/__tests__/QueueProgress.test.tsx`

**Features implemented:**
- Queue panel shows current processing item with spinner
- Shows pending, completed, and failed sections
- Progress bar with percentage, elapsed time, and ETA
- Collapsible logs section within the queue panel
- Retry button for failed items
- Keyboard shortcut `q` to toggle queue panel

**Keyboard shortcut added:**
- `q` - Toggle queue panel visibility (added to shortcuts.ts)

---

#### 5.5 Pagination & Virtualization
**Priority:** P1 | **Effort:** Medium | **File:** `ui/src/components/IssueTable.tsx`

All issues rendered without pagination. Add:

- [ ] Add `@tanstack/react-virtual` dependency
- [ ] Implement virtualized list for 100+ items
- [ ] Add page size selector: 25, 50, 100, All
- [ ] Add "Load more" button option
- [ ] Create `useVirtualList.ts` hook wrapper

---

#### 5.6 Export Functionality ✅ COMPLETED
**Priority:** P1 | **Effort:** Small | **File:** `ui/src/lib/export.ts`

Export functionality implemented as part of Phase 3:

- [x] Created `export.ts` with CSV and JSON generation
- [x] Implemented client-side generation (no server round-trip)
- [x] Added configurable field selection via ExportDialog
- [x] Filename format: `meta-ralph-issues-{date}.{format}`

**File created:**
- `ui/src/lib/export.ts`

---

### Phase 6: Polish & Advanced (P2)

#### 6.1 Theme Toggle (Dark/Light)
**Priority:** P2 | **Effort:** Small | **Files:** `globals.css`, `ui/src/contexts/ThemeContext.tsx`

Only dark theme exists. Add:

- [ ] Create `ThemeContext.tsx` for theme management
- [ ] Add light theme CSS variables to `globals.css`
- [ ] Persist preference in localStorage
- [ ] Add system preference detection (`prefers-color-scheme`)
- [ ] Add theme toggle button in header

**Light theme colors:**
```css
--background: #ffffff;
--foreground: #171717;
--card: #f4f4f5;
--border: #e4e4e7;
```

---

#### 6.2 Saved Filters/Views
**Priority:** P2 | **Effort:** Medium | **Directory:** `ui/src/components/views/`

No saved views. Add per PRD-001:

- [ ] Create `SavedViews.tsx` - Dropdown with saved views
- [ ] Create `SaveViewDialog.tsx` - Name and save modal
- [ ] Create `ViewManager.tsx` - List/edit/delete saved views
- [ ] Create `useSavedViews.ts` hook
- [ ] Implement localStorage persistence
- [ ] Support sharing view via URL

---

#### 6.3 History of Processed Issues
**Priority:** P2 | **Effort:** Medium | **Directory:** `ui/src/components/history/`

Logs exist in `.ralph-logs/` but no UI. Add:

- [ ] Create history view component
- [ ] Parse `.ralph-logs/` directory for past attempts
- [ ] Show success/failure status with timestamps
- [ ] Extract PR links from processing results
- [ ] Add retry capability for failed issues
- [ ] Filter by date range and status

---

#### 6.4 Real-time Updates (SSE)
**Priority:** P2 | **Effort:** Medium | **Files:** `api/issues/stream/route.ts`, `useSSE.ts`

Currently polling every 2 seconds. Upgrade to SSE:

- [ ] Create `GET /api/issues/stream` SSE endpoint
- [ ] Create `useSSE.ts` hook for SSE connection
- [ ] Implement fallback to polling
- [ ] Push events: new issues, processing status, completion

---

#### 6.5 Issue Tagging/Labeling
**Priority:** P2 | **Effort:** Medium | **Directory:** `ui/src/components/tags/`

No tagging system. Add per PRD-001:

- [ ] Create `TagInput.tsx` - Autocomplete tag input
- [ ] Create `TagBadge.tsx` - Colored tag display
- [ ] Create `TagManager.tsx` - CRUD for tags
- [ ] Store tags in localStorage
- [ ] Add filter by tags functionality
- [ ] Support bulk tag assignment

---

### Phase 7: Optional Enhancements (P3)

#### 7.1 Drag-and-Drop Reordering
**Priority:** P3 | **Effort:** Medium

- [ ] Add `@dnd-kit/core` and `@dnd-kit/sortable` dependencies
- [ ] Implement drag handles on rows
- [ ] Add visual drop zone feedback
- [ ] Persist manual order in session

---

#### 7.2 Undo/Redo for Selections
**Priority:** P3 | **Effort:** Small | **File:** `ui/src/hooks/useSelectionHistory.ts`

- [ ] Implement selection history stack (last 10 states)
- [ ] Add keyboard shortcuts: `Ctrl+Z` undo, `Ctrl+Shift+Z` redo
- [ ] Show undo toast with "Redo" button

---

### Phase 8: Additional Providers (P2-P3)

#### 8.1 GitHub Issues Provider
**Priority:** P2 | **Effort:** Medium | **File:** `providers/github/provider.sh`

Directory exists but is empty. Implement:

- [ ] Implement GitHub Issues API integration
- [ ] Map GitHub labels to priority (security=95, bug=40, enhancement=10)
- [ ] Generate appropriate PRDs for GitHub issues
- [ ] Support filtering by labels and milestones

---

#### 8.2 Jira Provider
**Priority:** P3 | **Effort:** Medium | **Directory:** `providers/jira/`

Not started. Create if needed:

- [ ] Create Jira provider implementation
- [ ] Map Jira priorities to 0-100 scale
- [ ] Support JQL queries for issue filtering

---

#### 8.3 Linear Provider
**Priority:** P3 | **Effort:** Medium | **Directory:** `providers/linear/`

Not started. Create if needed:

- [ ] Create Linear provider implementation
- [ ] Integrate with Linear GraphQL API
- [ ] Map Linear priorities to 0-100 scale

---

### Phase 9: Infrastructure Improvements (P2-P3)

#### 9.1 Parallel Processing
**Priority:** P2 | **Effort:** Medium | **Files:** `meta-ralph.sh`, `lib/ralph-engine.sh`

`--parallel` flag exists but appears sequential. Fix:

- [ ] Implement true parallel processing with `--parallel N`
- [ ] Add job coordination to prevent branch conflicts
- [ ] Implement proper progress tracking for parallel jobs

---

#### 9.2 Issue Deduplication
**Priority:** P2 | **Effort:** Small | **File:** `lib/dedup.sh`

No deduplication. Add:

- [ ] Detect duplicate issues across providers
- [ ] Merge duplicate issues with combined metadata
- [ ] Show dedup info in UI

---

#### 9.3 Slack Notifications
**Priority:** P3 | **Effort:** Small | **File:** `lib/notifications.sh`

Not started. Add if needed:

- [ ] Add Slack webhook integration
- [ ] Send notifications on processing start/complete
- [ ] Include PR links in success notifications

---

## File Structure (Target)

### New UI Files
```
ui/src/
├── components/
│   ├── filters/
│   │   ├── FilterBar.tsx
│   │   ├── FilterChip.tsx
│   │   ├── FilterPreset.tsx
│   │   ├── RangeSlider.tsx
│   │   ├── DateRangePicker.tsx
│   │   └── index.ts
│   ├── search/
│   │   ├── SearchBar.tsx
│   │   ├── SearchHighlight.tsx
│   │   └── index.ts
│   ├── views/
│   │   ├── GroupedView.tsx
│   │   ├── GroupHeader.tsx
│   │   ├── ViewToggle.tsx
│   │   ├── SavedViews.tsx
│   │   ├── SaveViewDialog.tsx
│   │   └── index.ts
│   ├── actions/
│   │   ├── BulkActionBar.tsx
│   │   ├── ActionConfirmDialog.tsx
│   │   ├── ExportDialog.tsx
│   │   └── index.ts
│   ├── details/
│   │   ├── IssueDetailPanel.tsx
│   │   ├── IssueMetadata.tsx
│   │   ├── CodeSnippet.tsx
│   │   ├── ActionButtons.tsx
│   │   └── index.ts
│   ├── dashboard/
│   │   ├── Dashboard.tsx
│   │   ├── StatCard.tsx
│   │   ├── MiniChart.tsx
│   │   ├── ProviderPieChart.tsx
│   │   ├── SeverityBarChart.tsx
│   │   └── index.ts
│   ├── queue/
│   │   ├── ProcessingQueue.tsx
│   │   ├── QueueItem.tsx
│   │   ├── QueueProgress.tsx
│   │   └── index.ts
│   ├── tags/
│   │   ├── TagInput.tsx
│   │   ├── TagBadge.tsx
│   │   ├── TagManager.tsx
│   │   └── index.ts
│   ├── history/
│   │   ├── HistoryView.tsx
│   │   ├── HistoryItem.tsx
│   │   └── index.ts
│   └── common/
│       ├── KeyboardShortcuts.tsx
│       ├── ShortcutsModal.tsx
│       └── index.ts
├── hooks/
│   ├── useFilters.ts
│   ├── useSearch.ts
│   ├── useSort.ts
│   ├── useKeyboardShortcuts.ts
│   ├── useGrouping.ts          # Group state management hook
│   ├── useSavedViews.ts
│   ├── useLocalStorage.ts
│   ├── useVirtualList.ts
│   ├── useSelectionHistory.ts
│   └── useSSE.ts
├── contexts/
│   ├── AppContext.tsx
│   └── ThemeContext.tsx
├── lib/
│   ├── types.ts (extend)
│   ├── filters.ts
│   ├── export.ts
│   └── shortcuts.ts
└── app/
    └── api/
        └── issues/
            ├── bulk/
            │   └── route.ts
            └── stream/
                └── route.ts
```

### New Provider Files
```
providers/
├── codecov/
│   ├── provider.sh
│   ├── api.sh
│   ├── priority.sh
│   └── test-detection.sh
├── github/
│   └── provider.sh
├── jira/
│   └── provider.sh
└── linear/
    └── provider.sh
```

---

## Recommended Implementation Order

### Immediate (Quick Wins - Do First)
1. ~~**QW-1** - Extended types (foundation for all features)~~ ✅ COMPLETED
2. ~~**QW-2** - Table header sorting (visible improvement, low effort)~~ ✅ COMPLETED

### Week 1: Foundation
3. ~~**1.1** - Core hooks (useLocalStorage, useSort, useFilters, useSearch)~~ ✅ COMPLETED
4. ~~**1.2** - AppContext for global state~~ ✅ COMPLETED

### Week 2: Core Features
5. ~~**2.1** - Search functionality~~ ✅ COMPLETED
6. ~~**2.2** - Advanced filtering system~~ ✅ COMPLETED
7. **2.3** - Sorting with URL params (extends QW-2)

### Week 3: Actions & Details
8. ~~**3.1** - Bulk actions system~~ ✅ COMPLETED
9. ~~**3.2** - Issue detail panel~~ ✅ COMPLETED

### Week 4: Codecov Provider (can parallel with UI)
10. **4.1-4.5** - Full Codecov provider implementation

### Weeks 5-6: Enhanced UX
11. ~~**5.1** - Keyboard shortcuts~~ ✅ COMPLETED
12. ~~**5.2** - Grouping views~~ ✅ COMPLETED
13. ~~**5.3** - Dashboard with recharts~~ ✅ COMPLETED
14. **5.4** - Processing queue visualization
15. **5.5** - Pagination and virtualization
16. ~~**5.6** - Export functionality~~ ✅ COMPLETED (moved to Phase 3)

### Week 7+: Polish
17. **6.1** - Theme toggle
18. **6.2** - Saved views
19. **6.3** - Processing history
20. **6.4** - SSE real-time updates
21. **6.5** - Tagging system

### As Needed
22. **7.x** - Drag-drop, undo/redo
23. **8.x** - Additional providers (GitHub, Jira, Linear)
24. **9.x** - Infrastructure (parallel processing, dedup, Slack)

---

## Notes

- CLI core is **complete** - focus implementation effort on UI and Codecov provider
- UI uses Next.js 15.1.0 + React 19.0.0 (App Router)
- All state management via React hooks and context (no external state library)
- localStorage for persistence where specified
- URL query params should sync with filter/sort state for shareable links
- Codecov provider (Phase 4) can proceed in parallel with UI work
- Provider interface is defined in `lib/provider.sh` - new providers must implement 4 functions
